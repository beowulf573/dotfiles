unbind-key C-b
set -g prefix 'C-o'
bind-key 'C-o' send-prefix

set -g default-terminal "screen-256color" # colors!
setw -g xterm-keys on
set -s escape-time 0                      # fastest command sequences
set -s repeat-time 600                    # increase repeat timeout
set -s quiet on                           # disable various messages

set -g status-utf8 on                     # expect UTF-8
setw -g utf8 on

set history-limit 5000                    # boost history

# reload configuration
bind r source-file ~/.tmux.conf \; display '~/.tmux.conf sourced'

set -g base-index 1         # start windows numbering at 1
setw -g pane-base-index 1   # make pane numbering consistent with windows

setw -g automatic-rename on # rename window to reflect current program
# renumber windows when a window is closed, tmux > 1.6
if '[ $(echo "$(tmux -V | cut -d' ' -f 2) > 1.6" | bc) -eq 1 ]' 'set -g renumber-windows on'

set -g set-titles on                        # set terminal title
set -g set-titles-string '#h ❐ #S ● #I #W'

set -g display-panes-time 800 # slightly longer pane indicators display time
set -g display-time 1000      # slightly longer status messages display time

set -g status-interval 10     # redraw status line every 10 seconds

# 24 hour clock
setw -g clock-mode-style 24

# activity
set -g monitor-activity on
set -g visual-activity off

# split current window vertically
bind _ split-window -h
# split current window horizontally
bind - split-window -v

# pane navigation
bind -r h select-pane -L  # move left
bind -r j select-pane -D  # move down
bind -r k select-pane -U  # move up
bind -r l select-pane -R  # move right
bind > swap-pane -D       # swap current pane with the next one
bind < swap-pane -U       # swap current pane with the previous one

unbind +
bind + new-window -d -n tmux-zoom 'clear && echo TMUX ZOOM && read' \; swap-pane -s tmux-zoom.1 \; select-window -t tmux-zoom
unbind =
bind = last-window \; swap-pane -s tmux-zoom.1 \; kill-window -t tmux-zoom


# pane resizing
bind -r H resize-pane -L 2
bind -r J resize-pane -D 2
bind -r K resize-pane -U 2
bind -r L resize-pane -R 2

# window navigation
bind -r C-h previous-window # select previous window
bind -r C-l next-window     # select next window
bind Space last-window      # move to last active window

##CLIPBOARD selection integration
##Requires prefix key before the command key
#Copy tmux paste buffer to CLIPBOARD
#bind C-c run "tmux show-buffer | xclip -i -selection clipboard"
bind C-c run "tmux show-buffer | xclip"
#Copy CLIPBOARD to tmux paste buffer and paste tmux paste buffer
bind C-v run "tmux set-buffer -- \"$(xclip -o -selection clipboard)\"; tmux paste-buffer"

tmux_conf_theme=powerline_patched_font

# -- 8< ------------------------------------------------------------------------

run 'cut -c3- ~/.tmux.conf | sh -s apply_theme $tmux_conf_theme'
run 'for name in $(printenv | grep -Eo ^tmux_conf_[^=]+); do tmux setenv -gu $name; done;'


# ►_◄

# # exit the script if any statement returns a non-true return value
# set -e
#
# apply_theme() {
#   case "$1" in
#     powerline_patched_font)
#       left_separator='⮁'
#       left_separator_black='⮀'
#       right_separator='⮃'
#       right_separator_black='⮂'
#       session_symbol=''
#       ;;
#     powerline)
#       left_separator='|'
#       left_separator_black=' '
#       right_separator='|'
#       right_separator_black=' '
#       ;;
#   esac
#
#   case "$1" in
#     powerline*)
#
#       # panes
#       pane_border_fg=colour238        # light gray
#       pane_active_border_fg=colour39  # light blue
#
#       tmux set -g pane-border-fg $pane_border_fg \; set -g pane-active-border-fg $pane_active_border_fg
#       #uncomment for fat borders
#       #tmux set -g pane-border-bg $pane_border_fg \; set -g pane-active-border-bg $pane_active_border_fg
#
#       display_panes_active_colour=colour39 # light blue
#       display_panes_colour=colour39        # light blue
#       tmux set -g display-panes-active-colour $display_panes_active_colour \; set -g display-panes-colour $display_panes_colour
#
#       # messages
#       message_attr=bold
#       message_fg=colour16   #black
#       message_bg=colour226  #yellow
#       tmux set -g message-attr $message_attr \; set -g message-fg $message_fg \; set -g message-bg $message_bg
#
#       # windows mode
#       mode_attr=bold
#       mode_fg=colour16   #black
#       mode_bg=colour226  #yellow
#       tmux setw -g mode-attr $mode_attr \; set -g mode-fg $mode_fg \; set -g mode-bg $mode_bg
#
#       # status line
#       status_fg=colour253 # white
#       status_bg=colour232 # dark gray
#       tmux set -g status-fg $status_fg \; set -g status-bg $status_bg
#
#       session_fg=colour16  # black
#       session_bg=colour226 # yellow
#       status_left="#[fg=$session_fg,bg=$session_bg,bold] □ #S #[fg=$session_bg,bg=$status_bg,nobold]$left_separator_black"
#       tmux set -g status-left-length 32 \; set -g status-left "$status_left"
#
#       window_status_fg=colour245 # light gray
#       window_status_bg=colour232 # dark gray
#       window_status_format="#I #W"
#       tmux setw -g window-status-fg "$window_status_fg" \; setw -g window-status-bg "$window_status_bg" \; setw -g window-status-format "$window_status_format"
#
#       window_status_current_fg=colour16 # black
#       window_status_current_bg=colour39 # light blue
#       window_status_current_format="#[fg=$window_status_bg,bg=$window_status_current_bg]$left_separator_black#[fg=$window_status_current_fg,bg=$window_status_current_bg,bold] #I $left_separator #W #[fg=$window_status_current_bg,bg=$status_bg,nobold]$left_separator_black"
#       tmux setw -g window-status-current-format "$window_status_current_format"
#       tmux set -g status-justify left
#
#       window_status_activity_attr=underscore
#       window_status_activity_fg=default
#       window_status_activity_bg=default
#       tmux setw -g window-status-activity-attr "$window_status_activity_attr" \; setw -g window-status-activity-fg "$window_status_activity_fg" \; setw -g window-status-activity-bg "$window_status_activity_bg"
#
#       time_date_fg=colour245  # light gray
#       time_date_bg=colour232  # dark gray
#       whoami_fg=colour254     # white
#       whoami_bg=colour160     # red
#       host_fg=colour16        # black
#       host_bg=colour254       # white
#       status_right="#[fg=$time_date_fg,nobold]$right_separator %R $right_separator %d %b #[fg=$whoami_bg,bg=$time_date_bg,nobold]$right_separator_black#[fg=$whoami_fg,bg=$whoami_bg,nobold] #(whoami) $right_separator_black#[fg=$host_fg,bg=$host_bg,bold] #h "
#       tmux set -g status-right-length 64 \; set -g status-right "$status_right"
#
#       # clock
#       clock_mode_colour=colour39  # light blue
#       tmux setw -g clock-mode-colour $clock_mode_colour
#       ;;
#   esac
# }
#
# circled_digit() {
#   circled_digits='⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳'
#   if [ $1 -lt 20 ] 2>/dev/null ; then
#     echo ${circled_digits:$1:1}
#   else
#     echo $1
#   fi
# }
#
#
# $@
